@echo off
@title Brave downloader + configer ^| ver.1.0 [19.10.2023]
@cd /d "%~dp0"

@for /f "eol=- tokens=1-9 delims=/<>" %%a in ('@curl.exe -skLI "https://github.com/brave/brave-browser/releases/latest" -w "%%{url_effective}" ^| @FINDSTR /IRC:"Location"') do (@if not defined DefVerBrave (@set DefVerBrave=%%g))
@if "%PROCESSOR_ARCHITECTURE%" NEQ "AMD64" (@set "DefBitBr=win32-ia32") else (@set "DefBitBr=win32-x64")
@md "brave-%DefVerBrave%-%DefBitBr%" &@cd "brave-%DefVerBrave%-%DefBitBr%"
@curl.exe -RLO# "https://github.com/brave/brave-browser/releases/download/%DefVerBrave%/brave-%DefVerBrave%-%DefBitBr%.zip" &&@tar -xf "brave-%DefVerBrave%-%DefBitBr%.zip" &&@del /f /q "brave-%DefVerBrave%-%DefBitBr%.zip"

@set FilePath1=%~dp0brave-%DefVerBrave%-%DefBitBr%\brave.exe
@for /f "tokens=1* delims== usebackq" %%a in (`wmic datafile where name^='%FilePath1:\=\\%' get version /value`) do if not "%%b"=="" @set Version=%%b
@rd /q /s "%Version%\BraveVpnWireguardService" "%Version%\Extensions" "%Version%\MEIPreload" "%Version%\resources" "%Version%\VisualElements" > nul
@del /f /q /s "a*.pak" "bg.pak" "bn.pak" "ca.pak" "cs.pak" "d*.pak" "e?.pak" en-GB.pak en-XA.pak "es*.pak" "f*.pak" "g*.pak" "h*.pak" "i*.pak" "j*.pak" "k*.pak" "l*.pak" "m*.pak" "n*.pak" "o*.pak" "pt*.pak" "q*.pak" "ro.pak" "s*.pak" "t*.pak" "ur.pak" "v*.pak" "w*.pak" "z*.pak" > nul

@md "UserData\Default"
@set cr_loca1={"background_mode":{"enabled":false},"brave":{"ad_block":{"checked_default_region":true},"dark_mode":2,"default_browser_prompt_enabled":false,"dont_ask_for_crash_reporting":true,"new_tab_page":{"cached_referral_code":"","cached_super_referral_component_data":"","cached_super_referral_component_info":{},"customize_p3a_usage":2,"get_initial_sr_component_in_progress":true,"p3a_new_tabs_created":[]},"p3a":{"enabled":false,"notice_acknowledged":true},"referral":{"initialization":true,"promo_code":"BRV001"},"stats":{},"wallet":{"wallet_report_unlock_time_ping":"0"},"widevine_opted_in":false},"brave_shields":{"p3a_usage":3},"browser":{"enabled_labs_experiments":["ignore-gpu-blocklist","smooth-scrolling@2"]},"cloned_install":{"count":1},"hardware_acceleration_mode_previous":true,"invalidation":{"per_sender_topics_to_handler":{}},"legacy":{"profile":{"name":{"migrated":true}}},"management":{"platform":{"azure_active_directory":0,"enterprise_mdm_win":0}},"profile":{"last_used":"Default"},"profile_network_context_service":{"http_cache_finch_experiment_groups":"None None None None"}}
@set cr_pref1={"NewTabPage":{"DisabledModules":["dummy","dummy2"],"ModulesVisible":false},"alternate_error_pages":{"backup":false},"autocomplete":{"retention_policy_last_version":104},"autofill":{"credit_card_enabled":false,"enabled":false,"orphan_rows_removed":true,"profile_enabled":false},"bookmark_bar":{"show_apps_shortcut":false,"show_on_all_tabs":false,"show_reading_list":false},"brave":{"always_show_bookmark_bar_on_ntp":true,"autocomplete_enabled":false,"brave_ads":{},"default_private_search_provider_guid":"485bf7d3-0215-45af-87dc-538868000550","enable_media_router_on_restart":false,"fb_embed_default":false,"google_login_default":false,"hangouts_enabled":false,"location_bar_is_wide":true,"new_tab_page":{"clock_format":"","hide_all_widgets":false,"show_background_image":false,"show_clock":false,"show_rewards":false,"show_stats":false,"show_together":false,"shows_options":2},"other_bookmarks_migrated":true,"reduce_language":true,"rewards":{"version":11,"wallets":{}},"search":{"default_version":6},"shields_settings_version":4,"show_brave_rewards_button":false,"tabs_search_show":false,"twitter_embed_default":false,"wallet":{"default_wallet2":1,"ethereum_transactions":{},"keyrings":{},"selected_networks":{"ethereum":"0x1","filecoin":"f","solana":"0x65"},"show_wallet_icon_on_toolbar":false,"user":{}}},"brave_shields":{"p3a_ads_allow_domain_count":0,"p3a_ads_standard_domain_count":0,"p3a_ads_strict_domain_count":0,"p3a_first_reported":true,"p3a_fp_allow_domain_count":0,"p3a_fp_standard_domain_count":0,"p3a_fp_strict_domain_count":0},"brave_sync_v2":{"v1_meta_info_cleared":true,"v1_migrated":true},"browser":{"check_default_browser":false,"clear_data":{"browsing_history_basic":true,"cache_basic":true,"cache_on_exit":true,"cookies_basic":true,"download_history_on_exit":true,"form_data":true,"form_data_on_exit":true,"hosted_apps_data":true,"hosted_apps_data_on_exit":true,"media_licenses":true,"passwords":true,"passwords_on_exit":true,"preferences_migrated_to_basic":true,"site_settings":true,"site_settings_on_exit":true,"time_period":4,"time_period_basic":4},"clear_lso_data_enabled":true,"has_seen_welcome_page":true,"last_clear_browsing_data_tab":2,"window_placement":{"bottom":720,"left":64,"maximized":false,"right":960,"top":32}},"credentials_enable_autosignin":false,"credentials_enable_service":false,"default_apps_install_state":2,"download":{"directory_upgrade":true,"prompt_for_download":true},"enable_do_not_track":true,"extensions":{"alerts":{"initialized":true},"ui":{"developer_mode":true}},"media":{"engagement":{"schema_version":5}},"net":{"network_prediction_options":2},"omnibox":{"prevent_url_elisions":true},"payments":{"can_make_payment_enabled":false},"privacy_sandbox":{"apis_enabled":false,"fledge_join_blocked":{},"preferences_reconciled":true},"profile":{"avatar_bubble_tutorial_shown":2,"avatar_index":24,"block_third_party_cookies":true,"content_settings":{"clear_on_exit_migrated":true,"pref_version":1},"default_content_setting_values":{"background_sync":2,"cookies":1},"exit_type":"Normal","exited_cleanly":true,"local_avatar_index":24,"managed_user_id":"","name":"","password_manager_enabled":false,"were_old_google_logins_removed":true},"safebrowsing":{"enabled":false,"unhandled_sync_password_reuses":{}},"savefile":{"default_directory":"::{20D04FE0-3AEA-1069-A2D8-08002B30309D}"},"search":{"suggest_enabled":false},"tor":{"auto_onion_location":true},"zerosuggest":{"cachedresults":""}}
(@echo %cr_loca1%)>"UserData\Local State"
(@echo %cr_pref1%)>"UserData\Default\Preferences"
(@echo @start Brave.exe --user-data-dir=UserData --disable-gpu-shader-disk-cache --disk-cache-dir=nul --disk-cache-size=1 --disable-background-networking --disable-component-update --no-default-browser-check --disable-machine-id --disable-encryption-win --sync-url=localhost --lso-url=localhost --variations-server-url=localhost --variations-insecure-server-url=localhost)>"BraveLauncher.bat"

@echo Done!
@pause > nul